<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Check List TD360º – Herpac</title>
  <link rel="stylesheet" href="estilos.css">
</head>
<body>
  <header class="site-header">
    <img src="logo_herpac.svg" alt="HERPAC" class="logo">
    <h1>Check List TD360º</h1>
    <img src="logo_td.svg" alt="TD Consulting" class="logo">
  </header>

  <main>
    <!-- Stepper y Bloques 1–4 (tu contenido validado) -->

    <!-- FORMULARIO: usa SIEMPRE este form con este id/action/method -->
    <form id="checklistForm" action="https://formspree.io/f/xqadrqzl" method="POST">
      <!-- aquí van todos tus campos de los 4 bloques -->

      <!-- redirecciones de respaldo -->
      <input type="hidden" name="redirect" value="">
      <input type="hidden" name="_redirect" value="">
      <input type="hidden" name="_next" value="">

      <!-- botón enviar (dentro o fuera del form). Si lo dejas dentro, usa type="submit". -->
      <div class="acciones">
        <button id="submitBtn" type="submit">Enviar</button>
      </div>
    </form>
  </main>

  <!-- Script de envío robusto + redirect correcto en GitHub Pages -->
  <script>
  (function(){
    var form = document.getElementById('checklistForm');
    if(!form) return;

    function basePath(){
      var p = window.location.pathname;
      return p.endsWith('/') ? p : p.replace(/[^\/]+$/, '/');
    }
    var gracias = window.location.origin + basePath() + 'gracias.html';

    function setRedirectHidden(){
      ['redirect','_redirect','_next'].forEach(function(name){
        var el = form.querySelector('input[name="'+name+'"]');
        if(!el){ el = document.createElement('input'); el.type='hidden'; el.name=name; form.appendChild(el); }
        el.value = gracias;
      });
    }
    setRedirectHidden();

    // Si el botón estuviera fuera del form en tu maqueta, este puente lo enviaría igual:
    var btn = document.getElementById('submitBtn');
    if(btn){
      btn.addEventListener('click', function(ev){
        // Si es type=button, forzamos submit; si es submit, no hace falta
        if (btn.type === 'button') {
          ev.preventDefault();
          if(form.requestSubmit) form.requestSubmit(); else form.submit();
        }
      });
    }

    form.addEventListener('submit', async function(e){
      e.preventDefault();
      setRedirectHidden();
      try{
        var fd = new FormData(form);
        await fetch(form.action, { method:'POST', headers:{'Accept':'application/json'}, body:fd });
        window.location.href = gracias;
      }catch(err){
        form.submit(); // fallback duro
      }
    });
  })();
  </script>
</body>
</html>


